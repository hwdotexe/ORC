<div class="mx-0 my-5 lg:mx-3 shadow-md rounded-sm border {{ borderColor }}">
  <!-- 2 horizontal elements: chevron and vstack -->
  <!-- vstack has header and expanded -->
  <div class="flex">
    <!-- Chevron -->
    <div class="hidden w-fit lg:block lg:flex-initial text-gray-500 border-r border-gray-300 hover:cursor-pointer" (click)="toggleExpand()">
      <div class="p-3">
        <i class="fa-solid fa-chevron-right text-2xl w-[21px]" *ngIf="!isExpanded"></i>
        <i class="fa-solid fa-chevron-down text-2xl w-[21px]" *ngIf="isExpanded"></i>
      </div>
    </div>

    <!-- VStack -->
    <div class="flex-1 p-4">
      <!-- Header -->
      <div class="flex hover:cursor-pointer" (click)="toggleExpand()">
        <!-- 2 horizontal elements: title/tags and stars -->
        <div class="flex-1">
          <!-- Title -->
          <p class="text-xl font-semibold pb-2 lg:pb-3">{{ review.review.clubName }}</p>

          <!-- Tags -->
          <div class="inline-block">
            <app-tag *ngIf="isRecent()" text="New Review"></app-tag>
            <app-tag *ngIf="isOld()" text="Old Review"></app-tag>

            <ng-container *ngFor="let tag of sortedTags">
              <app-tag text="{{ tag }}"></app-tag>
            </ng-container>
          </div>
        </div>

        <!-- Stars -->
        <app-stars class="flex-initial m-auto" rating="{{ review.review.starRating }}"></app-stars>
      </div>

      <!-- Expanded -->
      <div *ngIf="isExpanded" class="mt-2 bg-gray-100 rounded-md text-gray-700">
        <div class="p-4 lg:flex">
          <!-- Hours Data -->
          <div class="lg:flex-initial p-3 text-center bg-gray-200 rounded-md">
            <p class="font-semibold bg-gray-300 rounded-md p-1 px-2">
              <i class="fa-solid fa-clock p-1"></i>
              Hours
            </p>
            <p class="my-1 lg:my-2 text-sm font-semibold {{ hoursStatusColor }}">{{ clubTimeStatus }}</p>
            <div *ngFor="let hourEntry of review.review.clubHours" class="text-left mb-2 lg:mb-3">
              <div *ngIf="hourEntry.day; else variable">
                <p class="font-semibold text-sm">{{ hourEntry.day }}</p>
                <p class="text-sm">{{ hourEntry.open | time: false }} - {{ hourEntry.close | time: true }}</p>
              </div>
              <ng-template #variable>
                <p class="font-semibold text-sm">{{ hourEntry.variableDay }}</p>
                <p class="text-sm">{{ hourEntry.variableTimes }}</p>
              </ng-template>
            </div>
          </div>

          <!-- Review Info -->
          <div class="lg:flex-1 py-4 lg:px-4 lg:py-0 text-center">
            <!-- Review Header -->
            <div class="inline-block m-auto w-full p-2 bg-gray-200 rounded-md">
              <!-- Location -->
              <div class="mx-1 my-0.5 inline-block bg-gray-300 rounded-md p-1 px-2">
                <i class="fa-solid fa-location-dot p-1 mr-1"></i>
                <p class="inline-block text-sm">
                  {{ review.review.clubDatacenter }}, {{ review.review.clubServer }}, {{ review.review.clubDistrict }}, Ward
                  {{ review.review.clubWard }}, Plot
                  {{ review.review.clubPlot }}
                </p>
              </div>

              <!-- Website -->
              <a href="{{ review.review.website }}" target="_blank" *ngIf="review.review.website?.length > 0" class="inline-block">
                <div class="mx-1 my-0.5 inline-block bg-gray-300 rounded-md p-1 px-2">
                  <i class="fa-solid fa-globe p-1 mr-1"></i>
                  <p class="inline-block text-sm">{{ review.review.website }}</p>
                  <i class="fa-solid fa-arrow-up-right-from-square text-xs p-1.5 pt-1 align-top text-gray-500"></i>
                </div>
              </a>
            </div>

            <!-- Review Text -->
            <div class="my-3">
              <p class="text-xl font-semibold mb-3 p-1 lg:p-3 border-b border-gray-400 lg:w-3/4 m-auto">"{{ review.review.reviewTitle }}"</p>

              <ng-container *ngFor="let line of reviewSummaryLines">
                <p class="text-left">{{ line }}</p>
                <br *ngIf="!isLineLast(line)" />
              </ng-container>
            </div>
          </div>

          <!-- Reviewer Details -->
          <div class="lg:flex-initial p-3 text-center bg-gray-200 rounded-md">
            <p class="font-semibold bg-gray-300 rounded-md p-1 px-2">
              <i class="fa-solid fa-user p-1"></i>
              Reviewed by
            </p>

            <div class="inline-block my-2 lg:my-3">
              <img
                src="{{ review.user.characterAvatarURL }}"
                class="align-text-bottom rounded-md w-[64px] inline-block lg:mb-3 lg:m-auto lg:block lg:w-fit"
              />

              <div class="inline-block mx-2 text-left lg:text-center lg:block">
                <app-reviewer-name [accountType]="review.user.accountType">
                  {{ review.user.characterName }}
                </app-reviewer-name>
                <p class="text-sm">{{ review.user.characterServer }}</p>
                <p class="text-xs my-1">{{ review.review.dateCreated | date }}</p>
              </div>

              <div class="inline-block" *ngIf="canEditDeleteReview$ | async">
                <button styled-green class="block lg:inline-block m-1" [routerLink]="['/edit-review']" [queryParams]="{ id: review.review.reviewID }">
                  <i class="fa-solid fa-pencil"></i>
                </button>
                <button styled-red class="block lg:inline-block m-1" (click)="clickDelete()">
                  <i class="fa-solid fa-trash-can" *ngIf="!isDeleting"></i>
                  <i class="fa-solid fa-check" *ngIf="isDeleting"></i>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Report link -->
        <p class="text-xs text-right px-4 pb-3 text-gray-500">
          <a class="underline" [routerLink]="['/report']" [queryParams]="{ id: review.review.reviewID }">Report</a>
        </p>
      </div>
    </div>
  </div>
</div>
